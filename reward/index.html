<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Challenge URL Creator</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    .container {
      max-width: 700px; margin: auto;
      background: white; padding: 20px;
      border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, select, button {
      width: 100%; padding: 10px; margin: 10px 0;
      box-sizing: border-box;
      border: 1px solid #ccc; border-radius: 5px;
    }
    button {
      background-color: #007bff; color: white; border: none; cursor: pointer;
      font-weight: bold;
    }
    button:hover { background-color: #0056b3; }
    .puzzle { margin-top: 20px; }
    #dragDropPuzzle {
      display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px;
      user-select: none;
      justify-content: center;
    }
    #pieces, #dropzones {
      display: flex; flex-wrap: wrap; gap: 10px;
      justify-content: center;
    }
    .draggable {
      border: 2px solid #007bff;
      border-radius: 8px;
      background-repeat: no-repeat;
      cursor: grab;
      box-sizing: border-box;
    }
    .dropzone {
      border: 2px dashed #007bff;
      border-radius: 8px;
      box-sizing: border-box;
    }
    label.inline {
      display: inline-block;
      width: 48%;
      box-sizing: border-box;
    }
    label.inline input {
      width: 90%;
      margin-left: 4%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Challenge URL Creator</h2>

    <label for="rewardUrl">Reward URL:</label>
    <input type="text" id="rewardUrl" placeholder="https://example.com/reward" />

    <label for="challengeType">Challenge Type:</label>
    <select id="challengeType">
      <option value="">-- Select a challenge --</option>
      <option value="dragdrop">Drag and Drop Puzzle</option>
      <option value="uploadimage">Upload Image to Webhook</option>
    </select>

    <div id="extraInputArea"></div>

    <button onclick="generateChallengeURL()">Generate Challenge URL</button>

    <p id="generatedUrl"></p>

    <div class="puzzle" id="puzzleArea"></div>
  </div>

  <script>
    const challengeTypeSelect = document.getElementById('challengeType');
    const extraInputArea = document.getElementById('extraInputArea');

    challengeTypeSelect.addEventListener('change', () => {
      const val = challengeTypeSelect.value;
      extraInputArea.innerHTML = '';

      if (val === 'dragdrop') {
        extraInputArea.innerHTML = `
          <label for="puzzleImageUrl">Puzzle Image URL (wide images work best):</label>
          <input type="url" id="puzzleImageUrl" placeholder="https://example.com/image.jpg" />
          <div style="display:flex; gap:10px;">
            <label class="inline">Rows:
              <input type="number" id="puzzleRows" min="1" max="10" value="1" />
            </label>
            <label class="inline">Columns:
              <input type="number" id="puzzleCols" min="1" max="10" value="3" />
            </label>
          </div>
        `;
      } else if (val === 'uploadimage') {
        extraInputArea.innerHTML = `
          <label for="webhookUrl">Webhook URL:</label>
          <input type="url" id="webhookUrl" placeholder="https://your-webhook.url" />
        `;
      }
    });

    function xorEncryptDecrypt(input, key) {
      let result = '';
      for (let i = 0; i < input.length; i++) {
        result += String.fromCharCode(input.charCodeAt(i) ^ key.charCodeAt(i % key.length));
      }
      return result;
    }

    function base64EncodeWithKey(str, key) {
      const encrypted = xorEncryptDecrypt(str, key);
      return btoa(unescape(encodeURIComponent(encrypted)));
    }

    function base64DecodeWithKey(encoded, key) {
      const decrypted = decodeURIComponent(escape(atob(encoded)));
      return xorEncryptDecrypt(decrypted, key);
    }

    function generateChallengeURL() {
      const rewardUrl = document.getElementById('rewardUrl').value.trim();
      const challengeType = challengeTypeSelect.value;

      if (!rewardUrl || !challengeType) {
        alert('Please enter a reward URL and select a challenge type.');
        return;
      }

      let extraData = '';
      if (challengeType === 'dragdrop') {
        const puzzleImageUrl = document.getElementById('puzzleImageUrl')?.value.trim();
        const rows = parseInt(document.getElementById('puzzleRows')?.value, 10) || 1;
        const cols = parseInt(document.getElementById('puzzleCols')?.value, 10) || 3;

        if (!puzzleImageUrl) {
          alert('Please enter a puzzle image URL.');
          return;
        }
        if (rows < 1 || rows > 10 || cols < 1 || cols > 10) {
          alert('Rows and Columns must be between 1 and 10.');
          return;
        }
        extraData = JSON.stringify({ imageUrl: puzzleImageUrl, rows, cols });
      } else if (challengeType === 'uploadimage') {
        const webhookUrl = document.getElementById('webhookUrl')?.value.trim();
        if (!webhookUrl) {
          alert('Please enter a webhook URL.');
          return;
        }
        extraData = webhookUrl;
      }

      const combinedData = JSON.stringify({ rewardUrl, extraData });
      const encoded = base64EncodeWithKey(combinedData, challengeType);

      const challengeUrl = `${window.location.origin}${window.location.pathname}?data=${encoded}&type=${challengeType}`;
      document.getElementById('generatedUrl').innerHTML = `Challenge URL: <a href="${challengeUrl}" target="_blank">${challengeUrl}</a>`;
    }

    // Drag and Drop Puzzle Renderer with dynamic grid slicing
    function renderDragDropPuzzle(dataObj) {
      const puzzleDiv = document.getElementById('puzzleArea');
      let imageUrl = '', rows = 1, cols = 3;

      try {
        const extra = JSON.parse(dataObj.extraData);
        imageUrl = extra.imageUrl;
        rows = extra.rows;
        cols = extra.cols;
      } catch {
        puzzleDiv.textContent = 'Invalid puzzle data.';
        return;
      }

      puzzleDiv.innerHTML = `
        <p>Solve the drag and drop puzzle by placing the pieces in correct order:</p>
        <div id="dragDropPuzzle">
          <div id="pieces"></div>
          <div id="dropzones"></div>
        </div>
        <button onclick="checkDragDropPuzzle()">Submit Puzzle</button>
        <div id="puzzleResult" style="margin-top: 15px; font-weight: bold;"></div>
      `;

      const piecesContainer = document.getElementById('pieces');
      const dropzonesContainer = document.getElementById('dropzones');

      piecesContainer.style.width = `${cols * 100 + (cols - 1) * 10}px`;
      dropzonesContainer.style.width = `${cols * 100 + (cols - 1) * 10}px`;

      const totalPieces = rows * cols;
      const pieceIds = Array.from({ length: totalPieces }, (_, i) => `piece${i}`);

      // Create draggable pieces with background-position to show correct slice
      let pieces = pieceIds.map((id, index) => {
        const row = Math.floor(index / cols);
        const col = index % cols;

        const div = document.createElement('div');
        div.className = 'draggable';
        div.id = id;
        div.setAttribute('draggable', 'true');

        div.style.width = '100px';
        div.style.height = '100px';
        div.style.backgroundImage = `url('${imageUrl}')`;
        div.style.backgroundSize = `${cols * 100}px ${rows * 100}px`;
        div.style.backgroundPosition = `-${col * 100}px -${row * 100}px`;

        return div;
      });

      // Shuffle pieces randomly for initial position
      pieces.sort(() => Math.random() - 0.5);

      pieces.forEach(piece => piecesContainer.appendChild(piece));

      // Create dropzones in correct order
      pieceIds.forEach(id => {
        const dz = document.createElement('div');
        dz.className = 'dropzone';
        dz.dataset.accept = id;
        dz.style.width = '100px';
        dz.style.height = '100px';
        dropzonesContainer.appendChild(dz);
      });

      // Add drag/drop event handlers
      const draggables = document.querySelectorAll('.draggable');
      const dropzones = document.querySelectorAll('.dropzone');

      draggables.forEach(draggable => {
        draggable.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', e.target.id);
        });
      });

      dropzones.forEach(dropzone => {
        dropzone.addEventListener('dragover', e => e.preventDefault());
        dropzone.addEventListener('drop', e => {
          e.preventDefault();
          const pieceId = e.dataTransfer.getData('text/plain');
          const piece = document.getElementById(pieceId);
          if (dropzone.firstChild) drop

2/2







ChatGPT said:
zone.removeChild(dropzone.firstChild);
dropzone.appendChild(piece);
});
});

pgsql
Copy
Edit
  window.checkDragDropPuzzle = () => {
    let solved = true;
    dropzones.forEach((dz, i) => {
      const child = dz.firstChild;
      if (!child || child.id !== dz.dataset.accept) solved = false;
    });

    const resultDiv = document.getElementById('puzzleResult');
    if (solved) {
      resultDiv.innerHTML = `ðŸŽ‰ Puzzle solved! Here's your reward: <a href="${dataObj.rewardUrl}" target="_blank">${dataObj.rewardUrl}</a>`;
    } else {
      resultDiv.textContent = 'Incorrect arrangement. Please try again.';
    }
  };
}

window.onload = function() {
  const params = new URLSearchParams(window.location.search);
  if (params.has('data') && params.has('type')) {
    const type = params.get('type');
    try {
      const decoded = base64DecodeWithKey(params.get('data'), type);
      const dataObj = JSON.parse(decoded);

      if (type === 'dragdrop') {
        renderDragDropPuzzle(dataObj);
      } else {
        document.getElementById('puzzleArea').textContent = 'Unsupported challenge type.';
      }
    } catch (e) {
      document.getElementById('puzzleArea').textContent = 'Failed to decode challenge data.';
    }
  }
};
</script> </body> </html>
